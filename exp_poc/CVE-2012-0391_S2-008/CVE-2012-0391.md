#  CVE-2012-0391 S2-008 Apache Struts 输入验证漏洞

## Introduction

Apache Struts是美国阿帕奇（Apache）软件基金会负责维护的一个开源项目，是一套用于创建企业级Java Web应用的开源MVC框架，主要提供两个版本框架产品，Struts 1和Struts 2。

Apache Struts2 2.2.3.1之前版本中的ExceptionDelegator组件的翻译参数值中存在漏洞。当OGNL表达式在异常处理某些不匹配数据类型的属性时，远程攻击者可借助特制参数执行任意Java代码。

## Build Target
```shell
cd ~/vulhub/struts2/s2-008
docker-compose up -d
```

## Payload Usage
```shell
python3 CVE-2012-0391.py --ip 127.0.0.1 --port 8080 --cmd "ip a"
```

## REF

- [CVE-2012-0391](https://www.cvedetails.com/cve/CVE-2012-0391/?q=CVE-2012-0391)
- [Apache Struts 输入验证漏洞](http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-201201-074)